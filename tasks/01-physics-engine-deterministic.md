# Задача 01: Настройка детерминированного физического движка

## Приоритет: КРИТИЧЕСКИ ВЫСОКИЙ
## Оценка: Высокая
## Зависимости: Нет

## Описание
Интегрировать физический движок с **детерминированной физикой** - это критически важно для работы системы повторов. Физика должна быть полностью консистентной и не зависеть от FPS.

## Требования
- Установить и настроить физический движок
- Создать физический мир (physics world)
- Настроить гравитацию
- Интегрировать с React Three Fiber
- Обеспечить синхронизацию физических объектов с 3D моделями
- **КРИТИЧЕСКИ ВАЖНО:** Физика должна быть детерминированной (консистентной)
- **КРИТИЧЕСКИ ВАЖНО:** Физика не должна зависеть от FPS
- Физика должна выдавать одинаковый результат при повторных симуляциях с теми же параметрами
- Рендеринг должен быть 60 FPS (физика может работать с фиксированным timestep)
- Использовать фиксированный timestep для физики (например, 60 Hz или 120 Hz)
- Избегать всех источников недетерминированности (случайные значения, зависимости от точного времени)

## Технические детали
- Выбрать движок: cannon.js, @react-three/cannon, rapier или другой (учесть поддержку детерминированности)
- Создать провайдер физики для React Three Fiber
- Настроить базовые параметры физики (гравитация, масштаб)
- **Реализовать фиксированный timestep для физики** (независимо от FPS рендеринга)
- Использовать детерминированные алгоритмы (избегать случайных значений, использовать фиксированную точность)
- Разделить обновление физики и рендеринг (физика с фиксированным шагом, рендеринг 60 FPS)
- Использовать накопление времени (accumulator pattern) для обработки пропущенных кадров
- Убедиться, что все вычисления используют фиксированную точность (избегать float ошибок)

## Критерии приемки
- [ ] Физический движок установлен и работает
- [ ] Физический мир создан и обновляется с фиксированным timestep
- [ ] Гравитация настроена корректно
- [ ] Интеграция с R3F работает без ошибок
- [ ] **Физика детерминированная - одинаковый результат при повторных запусках с теми же входными данными**
- [ ] **Физика не зависит от FPS рендеринга**
- [ ] Рендеринг работает на 60 FPS
- [ ] Можно запустить одну и ту же симуляцию дважды и получить идентичный результат

## Связанные файлы
- `src/App.jsx` - главный компонент
- Новые файлы для физики (например, `src/physics/PhysicsWorld.jsx`)
- `src/physics/DeterministicPhysics.js` (новый файл с логикой детерминированной физики)

## Важные замечания
Эта задача является основой для системы повторов (Задача 34). Без детерминированной физики повторы работать не будут. Необходимо тщательно протестировать детерминированность перед переходом к следующим задачам.
