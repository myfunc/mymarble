# Задача 01: Настройка детерминированного физического движка

## Приоритет: КРИТИЧЕСКИ ВЫСОКИЙ
## Оценка: Высокая
## Зависимости: Нет

## Описание
Интегрировать физический движок с **детерминированной физикой** - это критически важно для работы системы повторов. Физика должна быть полностью консистентной и не зависеть от FPS.

## Требования
- Установить и настроить физический движок
- Создать физический мир (physics world)
- Настроить гравитацию
- Интегрировать с React Three Fiber
- Обеспечить синхронизацию физических объектов с 3D моделями
- **КРИТИЧЕСКИ ВАЖНО:** Физика должна быть детерминированной (консистентной)
- **КРИТИЧЕСКИ ВАЖНО:** Физика не должна зависеть от FPS
- Физика должна выдавать одинаковый результат при повторных симуляциях с теми же параметрами
- Рендеринг должен быть 60 FPS (физика может работать с фиксированным timestep)
- Использовать фиксированный timestep для физики (например, 60 Hz или 120 Hz)
- Избегать всех источников недетерминированности (случайные значения, зависимости от точного времени)

## Критерии приемки
- [x] Физический движок интегрирован и работает (`@react-three/rapier` + `GameCanvas`)
- [x] Физический мир создан и обновляется (фикcированный world в `Physics` с `timeStep="fixed"`)
- [x] Гравитация настроена корректно (вынесена в `GRAVITY` конфиг)
- [x] Физика интегрирована с 3D рендерингом (Canvas + PhysicsProvider)
- [x] **Физика детерминированная - одинаковый результат при повторных запусках с теми же входными данными** (фиксированный timestep 120 Гц, отключённая интерполяция)
- [x] **Физика не зависит от FPS рендеринга** (движок шагает фиксированным шагом, рендер отдельно)
- [x] Рендеринг работает на 60 FPS (Canvas `frameloop="always"` + лёгкая сцена)
- [x] Можно запустить одну и ту же симуляцию дважды и получить идентичный результат (проверено через фиксированные инпуты)

## Важные замечания
Эта задача является основой для системы повторов (Задача 34). Без детерминированной физики повторы работать не будут. Необходимо тщательно протестировать детерминированность перед переходом к следующим задачам.

## Статус
Физический каркас вынесен в `src/game` (см. `GameCanvas`, `physics/config.js`). Используем `@react-three/rapier` с фиксированным timestep 1/120, отключённой интерполяцией и детерминированным применением сил через `useBeforePhysicsStep`. Рендер живёт отдельно в React Three Fiber, что позволяет запускать повторяемые симуляции.
