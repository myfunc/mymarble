# Задача 34: Система записи и воспроизведения повторов

## Приоритет: Высокий
## Оценка: Очень высокая
## Зависимости: Задача 01 (детерминированная физика - КРИТИЧЕСКИ ВАЖНО), Задача 02, Задача 03

## Описание
Реализовать систему записи и воспроизведения повторов игры. Это требует детерминированной физики и независимости от FPS.

## Требования
- **КРИТИЧЕСКИ ВАЖНО:** Физика должна быть полностью детерминированной
- **КРИТИЧЕСКИ ВАЖНО:** Физика не должна зависеть от FPS
- Запись повтора игры (позиции шарика, состояния объектов каждый кадр)
- Воспроизведение записанного повтора
- Сохранение повторов в файл (JSON или бинарный формат)
- Загрузка повторов из файла
- Возможность просмотра повтора с разных ракурсов камеры
- Оптимизация хранения данных повтора (не хранить каждый кадр, если не нужно)

## Технические детали
- Убедиться, что физика детерминированная (фиксированный timestep, нет случайных значений)
- Система записи состояния игры каждый кадр (или с интервалом)
- Сериализация состояния для сохранения
- Система воспроизведения записанного состояния
- Интерполяция между кадрами для плавного воспроизведения
- Сжатие данных повтора (дельта-кодирование или другие методы)

## Критерии приемки
- [ ] Физика полностью детерминированная
- [ ] Физика не зависит от FPS
- [ ] Можно записать повтор игры
- [ ] Можно воспроизвести записанный повтор
- [ ] Повтор воспроизводится идентично оригинальной игре
- [ ] Повторы можно сохранять и загружать
- [ ] Можно просматривать повторы с разных ракурсов

## Связанные файлы
- `src/utils/replaySystem.js` (новый файл)
- `src/components/Replay/ReplayRecorder.jsx` (новый компонент)
- `src/components/Replay/ReplayPlayer.jsx` (новый компонент)
- `src/components/Replay/ReplayControls.jsx` (новый компонент)

## Важные замечания
Эта задача критически зависит от правильной реализации задачи 01 (детерминированная физика). Без детерминированной физики повторы будут работать некорректно.
